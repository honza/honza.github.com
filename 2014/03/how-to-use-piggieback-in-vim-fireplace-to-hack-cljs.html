<!doctype html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="description" content="Thoughts on web programming, open source hacking and the like. Honza Pokorny is a web developer in Halifax, Canada" >
  <meta name="viewport" content="width=550, maximum-scale=1.0" />
  <meta name="readability-verification" content="cXteMUVfc4F4DwUmDFS563269y9HLgfxK34fvdMC"/>
  <title>How to use piggieback in vim-fireplace to hack cljs - Honza Pokorny</title>
  <link rel="stylesheet" href="/media/screen.css" type="text/css" />
  <link rel="alternate" type="application/atom+xml" title="News-Feed" href="http://honza.ca/atom.xml" />
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-4330851-12']);
        _gaq.push(['_trackPageview']);

        (function(){
         var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>    

    <script type="text/javascript">
    /* <![CDATA[ */
        (function() {
            var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
            
            s.type = 'text/javascript';
            s.async = true;
            s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto'
            
            t.parentNode.insertBefore(s, t);
        })();
    /* ]]> */
    </script>
        
</head>
<body>

    <div id="wrap">
        <div id="banner" class="body">
            <h1><a href="/">Honza Pokorny</a></h1>
        </div>
        <p>Thoughts on web programming and the world of technology</p>
        

<p class="article_date date">
    March 20, 2014, reading time: about one minute
</p>

<div id="content">
    <div class="section" id="how-to-use-piggieback-in-vim-fireplace-to-hack-cljs">
<h1>How to use piggieback in vim-fireplace to hack&nbsp;cljs</h1>
<p>(That&#8217;s quite a title, isn&#8217;t&nbsp;it?)</p>
<p>If you&#8217;re using vim to write Clojure code, chances are that you&#8217;re using Tim
Pope&#8217;s vim-fireplace plugin.  It&#8217;s really great.  It stars an nREPL session in
the background for you and lets you evaluate a form inside of vim.  It&#8217;s super
fast because it keeps the session around and it&#8217;s one of my favorite things
about writing&nbsp;Clojure.</p>
<p>Recently, vim-fireplace received support for <a class="reference external" href="https://github.com/cemerick/piggieback">piggieback</a>.  Piggieback is a
layer on top of nREPL that gives you support for ClojureScript.  This is really
great because it gives you the ability to evaluate ClojureScript code in vim
just like your normal Clojure&nbsp;code.</p>
<p>Alright, here is how to set it&nbsp;up:</p>
<p><tt class="docutils literal">project.clj</tt></p>
<div class="highlight"><pre><span class="p">(</span><span class="kd">defproject </span><span class="nv">pig</span> <span class="s">&quot;0.1.0-<span class="caps">SNAPSHOT</span>&quot;</span>
  <span class="ss">:description</span> <span class="s">&quot;<span class="caps">FIXME</span>: write this!&quot;</span>
  <span class="ss">:url</span> <span class="s">&quot;http://example.com/<span class="caps">FIXME</span>&quot;</span>

  <span class="ss">:dependencies</span> <span class="p">[[</span><span class="nv">org.clojure/clojure</span> <span class="s">&quot;1.5.1&quot;</span><span class="p">]</span>
                 <span class="p">[</span><span class="nv">com.cemerick/piggieback</span> <span class="s">&quot;0.1.3&quot;</span><span class="p">]]</span>

  <span class="ss">:plugins</span> <span class="p">[[</span><span class="nv">lein-cljsbuild</span> <span class="s">&quot;1.0.2&quot;</span><span class="p">]]</span>
  <span class="ss">:repl-options</span> <span class="p">{</span><span class="ss">:nrepl-middleware</span> <span class="p">[</span><span class="nv">cemerick.piggieback/wrap-cljs-repl</span><span class="p">]}</span>

  <span class="ss">:source-paths</span> <span class="p">[</span><span class="s">&quot;src&quot;</span><span class="p">]</span>

  <span class="ss">:cljsbuild</span> <span class="p">{</span>
    <span class="ss">:builds</span> <span class="p">[{</span><span class="ss">:source-paths</span> <span class="p">[</span><span class="s">&quot;src&quot;</span><span class="p">]</span>
              <span class="ss">:compiler</span> <span class="p">{</span>
                <span class="ss">:target</span> <span class="ss">:nodejs</span>
                <span class="ss">:optimizations</span> <span class="ss">:simple</span><span class="p">}}]})</span>
</pre></div>
<p>Pretty standard stuff.  We&#8217;re using the lein-cljsbuild plugin for automatic
compilation, we set up the source path and a nodejs compile&nbsp;target.</p>
<p>Now you simply open a <tt class="docutils literal">.cljs</tt> file and you can do your usual vim-fireplace
magic.  The first <tt class="docutils literal">cpr</tt> (reload current buffer) command will connect to an
nREPL instance and initialize the piggieback&nbsp;wrapper.</p>
</div>

</div>

<span class="article_buttons">
    <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
    <a href="http://twitter.com/share" class="twitter-share-button"
        data-url="http://honza.ca/2014/03/how-to-use-piggieback-in-vim-fireplace-to-hack-cljs"
        data-via="_honza"
        data-text="How to use piggieback in vim-fireplace to hack cljs"
        data-count="none">Tweet</a>
    <a href="http://honza.ca/2014/03/how-to-use-piggieback-in-vim-fireplace-to-hack-cljs"
        class="FlattrButton"
        rev="flattr;uid:honza;button:compact;"
        title="How to use piggieback in vim-fireplace to hack cljs"
        style="display:none"></a>

</span>


    </div>

</body>
</html>